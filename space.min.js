function Space(a){this._clearProperties();this._values=[];this._cache={};return this._load(a)}Space.version="0.18.1";Space._isSpacePath=function(a){return-1<a.indexOf(" ")};Space.fromHeredoc=function(a,b,c){a=a.replace(/\n\r/g,"\n");a=a.split("\n");var e=null,d=[],f=RegExp("^"+b+"(?: |$)"),g=a.length;b=b.length;c=RegExp("^"+c);for(var h=0;h<g;h++)null===e?a[h].match(f)&&(e=h,a[h].length===b&&(a[h]+=" ")):a[h].match(c)?(e=null,d.push(h)):a[h]=" "+a[h];Space._removeItems(a,d);return new Space(a.join("\n"))};
Space.fromCsv=function(a,b){return Space.fromDelimiter(a,",",b)};
Space.fromDelimiter=function(a,b,c){var e=a.length,d="",f='"'===a.substr(0,1),g=f?1:0,h=[[]],j=new Space,l=0;for(c=!1!==c;g<e;){var m=a[g];"\r"!==m&&(f?'"'!==m?d+=m:'"'!==a[g+1]?(f=!1,g+1===e&&h[l].push(d)):(d+='"',g++):m===b?(h[l].push(d),d="",'"'===a[g+1]&&(f=!0,g++)):"\n"===m?(h[l].push(d),d="",l++,a[g+1]&&(h[l]=[]),'"'===a[g+1]&&(f=!0,g++)):g===e-1?h[l].push(d+m):d+=m);g++}var n=h[0];a=n.length;if(c)for(b=0;b<a;b++)n[b]=n[b].replace(/ /g,"");else{n=[];for(b=0;b<a;b++)n.push(b)}h.forEach(function(a,
b){if(0===b&&c)return!0;var e=new Space;n.forEach(function(b,c){var d=a[c];if(""===d)return!0;e.append(b,d)});j.append(c?b-1:b,e)});return j};Space.fromSsv=function(a,b){return Space.fromDelimiter(a," ",b)};Space.fromTsv=function(a,b){return Space.fromDelimiter(a,"\t",b)};Space._parseXml2=function(a){var b=document.createElement("div");b.innerHTML=a;return b};
Space._initializeXmlParser=function(){if(!Space._parseXml)if("undefined"!==typeof window.DOMParser)Space._parseXml=function(a){return(new window.DOMParser).parseFromString(a,"text/xml")};else if("undefined"!==typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM"))Space._parseXml=function(a){var b=new window.ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a);return b};else throw Error("No XML parser found");};
Space.fromXml=function(a){Space._initializeXmlParser();var b=Space._parseXml(a);try{return Space._fromXml(b).get("children")}catch(c){return Space._fromXml(Space._parseXml2(a)).get("children")}};
Space._fromXml=function(a){var b=new Space,c=new Space;if(a.attributes)for(var e=0;e<a.attributes.length;e++)b.set(a.attributes[e].name,a.attributes[e].value);a.data&&c.push(a.data);if(a.childNodes&&0<a.childNodes.length)for(e=0;e<a.childNodes.length;e++){var d=a.childNodes[e];if(d.tagName&&d.tagName.match(/parsererror/i))throw Error("Parse Error");0<d.childNodes.length&&d.tagName?c.append(d.tagName,Space._fromXml(d)):d.tagName?c.append(d.tagName,new Space):d.data&&(d=d.data.trim())&&c.push(d)}0<
c.length&&b.set("children",c);return b};Space._pairToString=function(a,b,c){a=Space._strRepeat(" ",c)+a;if(b instanceof Space)return a+"\n"+b._toString(c+1);b=b.toString();return-1<b.indexOf("\n")?a+" "+b.replace(/\n/g,"\n"+Space._strRepeat(" ",c+1))+"\n":a+" "+b+"\n"};Space._removeItems=function(a,b){var c=[];"number"===typeof b&&(b=[b]);for(var e=b.length-1;0<=e;e--)c.push(a.splice(b[e],1));return c};Space._strRepeat=function(a,b){for(var c="",e=0;e<b;e++)c+=a;return c};
Space.union=function(){for(var a=Space._unionSingle(arguments[0],arguments[1]),b=arguments.length,c=0;c<b&&!(1!==c&&(a=Space._unionSingle(a,arguments[c]),!a.length));c++);return a};Space._unionSingle=function(a,b){var c=new Space;if(!(b instanceof Space))return c;a.each(function(a,d){var f=b._getValueByProperty(a);d instanceof Space&&(f&&f instanceof Space)&&c._setPair(a,Space._unionSingle(d,b._getValueByProperty(a)));d===f&&c._setPair(a,d)});return c};
Space.prototype.append=function(a,b){this._setPair(a,b);return this.trigger("append",a,b).trigger("change")};Space.prototype.at=function(a){return this._getValueAt(a)};Space.prototype._clear=function(){this._clearProperties();this._values=[];this._cache={};return this};Space.prototype.clear=function(a){if(this.isEmpty())return this;this._clear();this.trigger("clear");a&&this._load(a);this.trigger("change");return this};
Space.prototype.clearListeners=function(a){if(!this._events)return this;if(a)delete this._events[a];else for(a in this._events)this._events.hasOwnProperty(a)&&delete this._events[a];return this};Space.prototype.clone=function(){return new Space(this.toString())};Space.prototype.concat=function(a){"string"===typeof a&&(a=new Space(a));var b=this;a.each(function(a,e){b.append(a,e)});return this};Space.prototype.create=function(a,b){this._setPair(a,b);return this.trigger("create",a,b).trigger("change")};
Space.prototype.deleteDuplicates=function(a){var b={};this.each(function(c,e,d){if(void 0!==b[c])return this._deleteByIndex(d),!0;b[c]=!0;a&&e instanceof Space&&e.deleteDuplicates(a)},null,!0);return this};Space.prototype._delete=function(a){return Space._isSpacePath(a)?this._deleteBySpacePath(a):this._deleteByProperty(a)};Space.prototype._deleteByIndex=function(a){if(void 0===this._values[a])return 0;this._deleteProperty(a);this._values.splice(a,1);this._reindex();return 1};
Space.prototype._deleteByIndexes=function(a){for(var b=a.length-1;0<=b;b--)this._deleteProperty(a[b]),this._values.splice(a[b],1);this._reindex();return this};Space.prototype._deleteByProperty=function(a){a=this.indexOf(a);return-1===a?0:this._deleteByIndex(a)};Space.prototype._deleteBySpacePath=function(a){var b=a.split(/ /);a=b.pop();b=this.get(b.join(" "));return b instanceof Space?b._delete(a):0};Space.prototype._deleteProperty=function(a){this._properties.splice(a,1);return this._getProperties()};
Space.prototype._getProperties=function(){return this._properties};Space.prototype._insertProperty=function(a,b){this._properties.splice(a,0,b)};Space.prototype._setProperty=function(a,b){this._properties[a]=b;return this._getProperties()};Space.prototype._clearProperties=function(){this._properties=[]};Space.prototype._reverseProperties=function(){this._properties.reverse()};Space.prototype.decrement=function(a,b){return this.increment(a,b||-1)};
Space.prototype.deepLength=function(){var a=0;this.every(function(){a++});return a};Space.prototype["delete"]=function(a){for(var b=!1;this._delete(a);)b=!0;return b?this.trigger("delete",a).trigger("change"):this};Space.prototype.deleteAt=function(a){var b=!1;"number"===typeof a?b=this._deleteByIndex(a):a&&a.length&&(b=this._deleteByIndexes(a));return b?this.trigger("delete",a).trigger("change"):this};
Space.prototype.diff=function(a){var b=new Space;a instanceof Space||(a=new Space(a));this.each(function(c){var d=a._getValueByProperty(c);if(void 0===d)return b._setPair(c,""),!0;var f=this._getValueByProperty(c),g=typeof d,h=typeof f;if(h!==g)return"object"===g?b._setPair(c,new Space(d)):f!=d&&b._setPair(c,d),!0;if("object"!==h)return f!==d&&b._setPair(c,d),!0;d=f.diff(d);d.length&&b._setPair(c,d)});var c=this;a.each(function(e,d){if(c.has(e))return!0;if("object"!==typeof d)return b._setPair(e,
d),!0;d instanceof Space?b._setPair(e,new Space(d)):b._setPair(e,new Space(a))});return b};Space.prototype.each=function(a,b,c){var e=this.length,d=this._getProperties();if(c)for(c=e-1;0<=c&&!(b&&this._values[c]instanceof Space&&this._values[c].each(a,b),!1===a.call(this,d[c],this._values[c],c));c--);else for(c=0;c<e&&!(b&&this._values[c]instanceof Space&&this._values[c].each(a,b),!1===a.call(this,d[c],this._values[c],c));c++);return this};
Object.defineProperty(Space.prototype,"events",{get:function(){return this._events||{}}});Space.prototype.every=function(a){this._every(a);return this};Space.prototype._every=function(a,b){var c=!0;this.each(function(e,d,f){var g=d instanceof Space;if(!g||!b)c=a.call(this,e,d,f);if(!1===c)return!1;g&&(c=d._every(a,b));return c});return c};Space.prototype.extract=function(a){a=a.split(" ");var b={},c=new Space;a.forEach(function(a){b[a]=!0});this._extract(b,c);return c};
Space.prototype._extract=function(a,b){this.each(function(c,e){a[c]?b.append(c,e):e instanceof Space&&e._extract(a,b)})};Space.prototype.everyLeaf=function(a){this._every(a,!0);return this};Space.prototype.filter=function(a){for(var b=new Space,c=this.length,e=this._getProperties(),d=0;d<c;d++)!0===a.call(this,e[d],this._values[d],d)&&b.append(e[d],this._values[d]);return b};
Space.prototype.find=function(a,b){var c=new Space;this.get(a)===b&&c.push(this);this.each(function(e,d){if(!(d instanceof Space))return!0;d.find(a,b).each(function(a,b){c.push(b)})});return c};Space.prototype.format=function(a){var b=this;return a.replace(/{([^\}]+)}/g,function(a,e){var d=b.get(e);return void 0!==d?d:""})};Space.prototype.get=function(a){return void 0===a||null===a?void 0:this._getValueByString(a.toString())};
Space.prototype.getAll=function(a){var b=new Space;this.each(function(c,e){if(c!==a)return!0;b.append(c,e)});return b};Space.prototype.getArray=function(a,b){var c=[];this._getArray(a,void 0===b?!0:b,c);return c};Space.prototype._getArray=function(a,b,c){this.each(function(e,d){e===a&&c.push(d);b&&d instanceof Space&&d._getArray(a,!0,c)})};Space.prototype.getColumn=function(a){var b=[];this.each(function(c,e){e instanceof Space&&b.push(e.get(a))});return b};
Space.prototype.getIndex=function(){var a=this.getParent(),b=this,c;if(!a)return-1;a.each(function(a,d,f){if(d===b)return c=f,!1});return c};Space.prototype.getParent=function(){return this._parent||null};Space.prototype.getPath=function(){for(var a=this._parent,b="",c=this,e="";a;)a.each(function(a,f){if(f===c)return b=a+e+b,e=" ",!1}),c=a,a=a._parent;return b};Space.prototype.getRoot=function(){var a=this._parent;if(!a)return this;for(;a._parent;)a=a._parent;return a||this};
Space.prototype.getBySpace=function(a){return this._getValueBySpace(a)};Space.prototype._getCachedValue=function(a){return this._values[this._cache[a]]};Space.prototype._getValueAt=function(a){0>a&&(a=this.length+a);return this._values[a]};Space.prototype._getValueByProperty=function(a){return this._getCachedValue(a)};Space.prototype._getPropertyByIndex=function(a){var b=this.length;0>a&&(a=b+a);return a>=b?void 0:this._getProperties()[a]};Space.prototype.getProperties=function(){return this._getProperties().slice(0)};
Space.prototype._getValueByString=function(a){if(a){var b=this._getValueByProperty(a);if(b||""===b||0===b||!1===b)return b;if(Space._isSpacePath(a)&&(a=a.split(/ /g),b=a.shift(),this.has(b)&&this._getValueByProperty(b)instanceof Space))return this._getValueByProperty(b).get(a.join(" "))}};
Space.prototype._getValueBySpace=function(a){var b=new Space,c=this;a.each(function(e){var d=c._getValueByProperty(e);if("undefined"===typeof d)return!0;if(!(a._getValueByProperty(e)instanceof Space)||!a._getValueByProperty(e).length)return b._setPair(e,d),!0;if(!(d instanceof Space))return!0;b._setPair(e,d._getValueBySpace(a._getValueByProperty(e)))});return b};Space.prototype.getValues=function(){return this._values.slice(0)};
Space.prototype.grab=function(a){var b=new Space,c=this;a.forEach(function(a){var d=c.get(a);d&&b.set(a,d)});return b};Space.prototype.group=function(a,b){"string"===typeof a&&(a=[a]);var c=new Space,e={};this.each(function(d,f,g){if(!(f instanceof Space))return!0;var h=f.grab(a);e[h]||(e[h]=new Space,c.push(e[h]));b&&b(e[h],f,d,g)});return c};Space.prototype.has=function(a){return void 0!==this._getValueByProperty(a)};
Space.prototype.increment=function(a,b){b=b||1;var c=this.get(a);void 0===c&&(c=0);this.set(a,parseFloat(c)+b);return this};Space.prototype.indexOf=function(a,b){if(!this.has(a))return-1;var c=this.length,e=this._getProperties();if(b)for(d=c-1;0<=d;d--){if(e[d]===a)return d}else for(var d=0;d<c;d++)if(e[d]===a)return d;return-1};Space.prototype.insert=function(a,b,c){this._setPair(a,b,c);return this};Space.prototype.isEmpty=function(){return 0===this.length};
Space.prototype.isFlat=function(){for(var a=this.length,b=0;b<a;b++)if(this._values[b]instanceof Space)return!1;return!0};Space.prototype.isStringMap=function(a){for(var b=this.length,c={},e,d=this._getProperties(),f=0;f<b;f++){e=d[f];if(c[e])return!1;c[e]=!0;if(a&&(e=this._values[f],!(!e instanceof Space)&&!e.isStringMap()))return!1}return!0};Object.defineProperty(Space.prototype,"length",{get:function(){return this._values.length}});Space._load2=!1;
Space.prototype._load=function(a,b){if(!a)return this;if("string"===typeof a)return Space._load2?this._loadFromString2(a):this._loadFromString(this._sanitizeString(a));if(a instanceof Space){var c=this;a.each(function(a,b){b instanceof Space?c._setPair(a,b.clone()):c._setPair(a,b)});return this}if(a instanceof Date||"function"===typeof a)return this._load(a.toString());b||(b=[a]);return this._loadFromObject(a,b)};
Space.prototype._loadFromObject=function(a,b){for(var c in a)a.hasOwnProperty(c)&&this._loadPair(c,a[c],b);return this};Space.prototype._loadPair=function(a,b,c){var e=typeof b;null===b?this._setPair(a,"null"):void 0===b?this._setPair(a,""):"object"!==e?this._setPair(a,b):b instanceof Date?this._setPair(a,b.getTime().toString()):b instanceof Space?this._setPair(a,b.clone()):"function"===e?this._setPair(a,b.toString()):-1===c.indexOf(b)&&(c.push(b),this._setPair(a,(new Space)._load(b,c)))};
Space.prototype._loadFromString2=function(a){for(var b="",c="",e="",d="",f=0,g=0,h={"0":this},j=0,l=0,m=!1,n=a.length,p=0;p<n;p++){var k=a[p];if("\r"!==k&&(m||!("\n"===k||" "===k)))if(m||(m=e=!0),e)" "===k?(e=!1,d=!0,j=f>=g?g:f):"\n"===k?(e=!1,f>=g&&(f=g),g=f+1,h[g]=new Space,h[f]._setPair(b,h[g]),f=0,b=""):b+=k;else if(d)if(l&&" "===k)f++,l--;else if(l)h[j]._setPair(b,c.substr(0,c.length-1)),c="",e=!0,d=!1,b=k,l=0;else if("\n"===k){l=j+1;for(f=0;"\n"===a[p+1];)p++;p!==a.length-1&&(c+=k)}else c+=
k;else"\n"!==k&&(" "===k?f++:(e=!0,b=k))}e&&h[f]._setPair(b,new Space);d&&h[j]._setPair(b,c);return this};Space.prototype._sanitizeString=function(a){a=a.replace(/^\s*/,"");a=a.replace(/\r/g,"");return a=a.replace(/\n\n+/,"\n")};
Space.prototype._loadFromString=function(a){a=a.split(/\n(?! )/g);for(var b=a.length,c,e,d=0;d<b;d++)e=a[d],(c=e.match(/^([^ ]+)(\n|$)/))?this._setPair(c[1],(new Space)._loadFromString(e.substr(c[1].length).replace(/\n /g,"\n").replace(/^\n +/,"\n"))):(c=e.match(/^([^ ]+) /))&&this._setPair(c[1],e.substr(c[1].length+1).replace(/\n /g,"\n"));return this};
Space.prototype.map=function(a,b,c,e){if(!e)return(new Space(this)).map(a,b,c);for(var d=this.length,f=this._getProperties(),g=0;g<d;g++){var h=f[g];a&&(f=this._setProperty(g,a(h)));c&&this._values[g]instanceof Space?this._values[g].map(a,b,c,e):b&&(this._values[g]=b(this._values[g],f[g],h))}this._reindex();return this};
Space.prototype.mergeDuplicates=function(){var a={},b=[],c=this;this.each(function(e,d,f){if(!(d instanceof Space))return!0;void 0===a[e]?a[e]=f:(d.each(function(b,d){c.at(a[e]).set(b,d)}),b.push(f))});return this._deleteByIndexes(b)};Space.prototype.nest=function(a){var b=new Space;b.set(a,this);return this.reload(b.toString())};Space.prototype.next=function(a){return this._getPropertyByIndex(this.indexOf(a)+1)};
Space.prototype.off=function(a,b){if(!this._events||!this._events[a])return this;for(var c in this._events[a])this._events[a][c]===b&&this._events[a].splice(c,1);return this};Space.prototype.on=function(a,b){this._events||(this._events={});this._events[a]||(this._events[a]=[]);this._events[a].push(b);return this};Space.prototype.pairAt=function(a){return!this.length?new Space:(new Space).set(this.propertyAt(a),this.at(a))};
Space.prototype._patch=function(a){a instanceof Space||(a=new Space(a));var b=this;a.each(function(a,e){if("string"===typeof e)return""===e?b._delete(a):b.set(a,e,null,!0),!0;if("number"===typeof e)return b.set(a,e,null,!0),!0;if(e instanceof Space&&!e.length)return b._delete(a),!0;if(b._getValueByProperty(a)instanceof Space)return b._getValueByProperty(a)._patch(e),!0;b.set(a,new Space(e),null,!0)});return this};Space.prototype.patch=function(a){this._patch(a);return this.trigger("patch",a).trigger("change")};
Space.prototype.pop=function(){if(!this.length)return null;var a=new Space,b=this._getPropertyByIndex(-1),c=this._getValueByProperty(b);a.set(b,c);this._deleteByIndex(this.length-1);return a};Space.prototype.prepend=function(a,b){return this._setPair(a,b,0)};Space.prototype.prev=function(a){return this._getPropertyByIndex(this.indexOf(a)-1)};Space.prototype.propertyAt=function(a){if(this.length)return 0>a&&(a=this.length+a),this._getProperties()[a]};
Space.prototype.push=function(a){for(var b=this.length;this.get(b.toString());)b++;this._setPair(b.toString(),a);return this};Space.prototype.reload=function(a){this._clearProperties();this._values=[];this._cache={};this._load(a);this.trigger("reload");return this};Space.prototype._rename=function(a,b){var c=this.indexOf(a);if(-1===c)return this;this._setPair(b,this._getValueByProperty(a),c,!0);return this};
Space.prototype.rename=function(a,b,c,e){if(c)return this._renameAll(a,b,e);this._rename(a,b);a!==b&&this.trigger("rename",a,b);this.trigger("change");return this};Space.prototype._renameAll=function(a,b,c){this.each(function(e,d,f){e===a&&this._setPair(b,d,f,!0);c&&d instanceof Space&&d._renameAll(a,b,c)});return this};Space.prototype.renameObjects=function(a){this.each(function(b,c,e){if(!(c instanceof Space))return!0;b=c.get(a);this._setProperty(e,b);c["delete"](a)});this._reindex();return this};
Space.prototype.replace=function(a,b){return this.reload(this.toString().replace(a,b))};Space.prototype.reverse=function(){this._reverseProperties();this._values.reverse();this._reindex();return this};Space.prototype.set=function(a,b,c,e){a=a.toString();Space._isSpacePath(a)?this._setBySpacePath(a,b):c?this._setPair(a,b,c):this.has(a)?this._setPair(a,b,this.indexOf(a),!0):this._setPair(a,b);e||this.trigger("set",a,b,c).trigger("change");return this};
Space.prototype._sanitizeSpacePath=function(a){return a.toString().replace(/\n/g,"").replace(/^ +/,"").replace(/  /g,"")};Space.prototype._setBySpacePath=function(a,b){a=a?this._sanitizeSpacePath(a):!1;if(!a)return null;for(var c=a.split(/ /g),e=this,d,f,g,h=c.length,j=0;j<h;j++){d=c[j];if((f=j===c.length-1)||!(e._getValueByProperty(d)instanceof Space))g=f?b:new Space,e.has(d)?(f=e.indexOf(d),e._setPair(d,g,f,!0)):e._setPair(d,g);e=e.get(d)}return this};
Space.prototype._setPair=function(a,b,c,e){if(a=a.toString()){var d=this.length,f=b instanceof Space,g=typeof b;!f&&("object"===g&&b)&&(b=new Space(b),f=!0);"string"!==g&&("number"!==g&&!f)&&(b=String(b));f&&(b._parent=this);void 0===c||c>=d?(this._setProperty(d,a),this._values.push(b),this._cache[a]=d):(e&&0<=c?(this._setProperty(c,a),this._values[c]=b):(this._insertProperty(c,a),this._values.splice(c,0,b)),this._reindex(c))}};
Space.prototype._reindex=function(a){var b=this.length,c=this._getProperties();a=a||0;a||(this._cache={});for(;a<b;a++)this._cache[c[a]]=a};Space.prototype.shift=function(){if(!this.length)return null;var a=this._getPropertyByIndex(0),b=new Space;b.set(a,this.get(a));this._deleteByIndex(0);return b};
Space.prototype.sort=function(a){for(var b=[],c=this._getProperties(),e=this.length,d=0;d<e;d++)b.push({property:c[d],value:this._values[d],index:d});b.sort(a);this._clear();for(d=0;d<e;d++)this._setPair(b[d].property,b[d].value);return this};Space.prototype.sortBy=function(a,b){this.sort(function(c,e){var d=c.value instanceof Space,f=e.value instanceof Space;if(!f&&!d)return 0;if(d){if(!f)return 1}else return-1;d=c.value.get(a);f=e.value.get(a);b&&(d=b(d),f=b(f));return d===f?0:d>f?1:-1});return this};
Space.prototype.split=function(a,b){var c=b?new Space:[],e=null;this.each(function(d,f){d===a&&(e&&(b?c.append(b,e):c.push(e)),e=new Space);if(!e)return!0;e.append(d,f)});e&&(b?c.append(b,e):c.push(e));return c};Space.prototype.tableOfContents=function(){return this.getProperties().join(" ")};Space.prototype.toCsv=function(){return this.toDelimited(",")};
Space.prototype.toDelimited=function(a,b){var c="",e=RegExp('(\\n|\\"|\\'+a+")"),d=function(a){return!a.match(e)?a:'"'+a.replace(/\"/g,'""')+'"'};b=b||[];var f={};b.length||this.each(function(a,c){if(!(c instanceof Space))return!0;c.each(function(a){if(f[a])return!0;b.push(a);f[a]=!0})});b.forEach(function(b){c+=a+d(b)});c=c.substr(1)+"\n";this.each(function(e,f){if(!(f instanceof Space))return!0;var j="";b.forEach(function(b){b=f.get(b)||"";j+=a+d(b.toString())});c+=j.substr(1)+"\n"});return c};
Space.prototype.toggle=function(a,b,c){this.get(a)===b?this.set(a,c):this.set(a,b);return this};Space.prototype.toJavascript=function(a){var b='new Space("'+this.toString().replace(/\n/g,"\\n").replace(/\"/g,'\\"')+'")';return a?b.replace(/\\n/g,"\\n\\\n"):b};Space.prototype.toJSON=function(a,b){return JSON.stringify(this.toObject(a),null,b?" ":null)};
Space.prototype._toObject=function(){var a=this.getProperties(),b=0<a.length,c=0;a.forEach(function(a){a!==c.toString()&&(b=!1);c++});var e=b?[]:{};this.each(function(a,c){var g;g=c instanceof Space?c._toObject():"false"===c?!1:"true"===c?!0:"null"===c?null:"number"===typeof c||c.match(/^[\-\.]?[0-9]+[0-9\.]*$/)?parseFloat(c):c;b?e.push(g):e[a]=g});return e};
Space.prototype.toObject=function(a){if(a)return this._toObject();var b={};this.each(function(a,e){b[a]=e instanceof Space?e.toObject():e});return b};Space.prototype.toQueryString=function(){var a="",b="";this.each(function(c,e){a+=b+encodeURIComponent(c)+"="+encodeURIComponent(e);b="&"});return a};Space.prototype.toSsv=function(){return this.toDelimited(" ")};Space.prototype.toString=function(){return this._toString(0)};
Space.prototype._toString=function(a){for(var b="",c=this._getProperties(),e=this.length,d=0;d<e;d++)b+=Space._pairToString(c[d],this._values[d],a);return b};Space.prototype.toTsv=function(){return this.toDelimited("\t")};Space.prototype.toURL=function(){return encodeURIComponent(this.toString())};Space.prototype.toXML=function(a){return this._toXML(a?0:-1)};
Space.prototype._toXML=function(a){var b="",c=-1===a?"":Space._strRepeat(" ",a);this.each(function(e,d){b+=c+"<"+e+">";d instanceof Space?0<d.length&&(b+=(-1===a?"":"\n")+d._toXML(-1<a?a+2:-1)+c):b+=d;b+="</"+e+">"+(-1===a?"":"\n")});return b};Space.prototype.toXMLWithAttributes=function(a){return this.at(0)._toXMLWithAttributes(this.propertyAt(0),a?0:-1)};
Space.prototype._toXMLWithAttributes=function(a,b){var c="",e=-1===b?"":Space._strRepeat(" ",b),d="",f="",g=this.get("children");this.each(function(a,b){if("children"===a)return!0;d=b&&b.replace?d+(" "+a+'="'+b.replace('"','\\"')+'"'):d+(" "+a)});g&&g.each(function(a,c){f=c instanceof Space?f+((-1===b?"":"\n")+c._toXMLWithAttributes(a,-1<b?b+2:-1)+e):f+c;if("children"===a)return!0});return c+(e+"<"+a+d+">"+f+"</"+a+">"+(-1===b||!f?"":"\n"))};
Space.prototype.trigger=function(a){if(!this._events||!this._events[a])return this;var b=Array.prototype.slice.call(arguments),c;for(c in this._events[a])this._events[a][c].apply(this,b.slice(1));return this};Space.prototype.trim=function(a){var b=[];this.each(function(c,e,d){e instanceof Space?(a&&e.trim(a),0===e.length&&b.push(d)):e||b.push(d)});return this._deleteByIndexes(b)};Space.prototype.update=function(a,b,c){this._setPair(b,c,a,!0);return this};Space.prototype.valueAt=function(a){return this.at(a)};
"undefined"!==typeof exports&&(module.exports=Space);
